<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="config-page">
  <template>
    <style>
      .container-vertical {
        @apply(--layout-vertical);
        @apply(--layout-center-justified)
      }
      .container-horizontal {
        @apply(--layout-horizontal);
        @apply(--layout-justified);
      }
      iron-selector a {
        text-decoration: none;
        color: black;
      }
      paper-card {
        margin: 0.5em 1em;
      }
      paper-item {
        font-size: 2em;
      }

      .flexchild {
        @apply(--layout-flex);
      }
      .flex3child {
        @apply(--layout-flex-3);
      }
      .flex4child {
        @apply(--layout-flex-4);
      }

      span {
        font-size:0.7em;
      }
    </style>
    <div class="container-vertical">
      <app-route route="{{route}}" pattern="/:page" tail="{{tailRoute}}">

      </app-route>
      <paper-card heading="Configuracion">
        <iron-selector attr-for-selected="name" selected="{{page}}" fallback="0">
          <a href="#/users" name="users">
              <paper-card  heading="Usuarios">
            </paper-card>
          </a>
          <a href="#/roles"name="roles">
              <paper-card  heading="Roles">
              </paper-card>
            </a>
        </iron-selector>
      </paper-card>
      <iron-ajax auto
      url="https://jsonplaceholder.typicode.com/users"
      handle-as="json"
      last-response="{{response}}">
    </iron-ajax>
    <paper-card name="users" heading="Usuarios">

      <iron-pages attr-for-selected="name" selected="{{page}}" fallback="0">

        <paper-card name="users">
          <template is="dom-repeat" items="[[response]]">
            <paper-item class="container-horizontal">
              <span class="flexchild">{{item.id}}</span>
              <span class="flex4child">{{item.name}}</span>
              <span class="flex3child">{{item.username}}</span>
              <span class="flex4child">{{item.email}}</span>
            </paper-item>
          </template>
        </paper-card>
        <!-- </div> -->
        <div name="roles">Roles</div>
      </iron-pages>
    </paper-card>

    </div>
  </template>

  <script>
    Polymer({

      is: 'config-page',

      properties: {
        page: {
          type: String,
          value: '0',
          observer: '_pageChanged'
        },
        route: {
          value: function () {
            return {path: '/', prefix: '', __queryParams: {}}
          }
        },
        pattern: {
          value: function () {
            let pathname = window.location.pathname
            return pathname.substring(0, pathname.lastIndexOf('/'))
          }
        }
      },
      // _ready: function () {
      //   this.page = 'configuration'
      // },
      _pageChanged: function () {
        console.log('--PAGE--',this.page);
        if (this.page) {
          if (this.page=='configuration') {}
        }
      }
    });
  </script>
</dom-module>
